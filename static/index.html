<!DOCTYPE html>
<script src='js/swagger-js.js' type='text/javascript'></script>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="line.css"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <meta charset=utf-8 />
</head>
<body class="body">
  <div class="container">
  <div class="row">
    <div class="col">
      <h1 class="text1">Text</h1>
      <hr color="white">
        <p class="lift"<span style='color: black'id="Lift"</span></p>
        <p class="drag"<span style='color: black'id="Drag"</span></p>
        <p class="amplitude" <span style='color: black'id="Amplitude"</span></p>
        <br>
        <br>
        <div class="slidecontainer">
  <input type="range" min="1" max="180" value="0" class="slider" id="myRange">
  <script>
  var host = location.protocol + "//" + location.host + "/api-docs";
  new SwaggerClient({
    url: host,
    usePromise: true
  }).then(function (client) {
    window.client = client;
  });

  var slider = document.getElementById("myRange");
  var output = document.getElementById("myRange");
  var sliderValue;
  output.innerHTML = slider.value; // Display the default slider value

  function myFunction(myRange) {
      if(myRange.target.value != sliderValue){
            console.log(myRange.target.value);
            sliderValue = myRange.target.value;
            window.client.Motor.setSpeed({speed: {
              speed: parseInt(myRange.target.value)
            }})
            .then(function() {
              console.log('set motor');
            })
      }
  }

// Update the current slider value (each time you drag the slider handle)
  slider.oninput = function() {
    output.innerHTML = this.value;
    slider.addEventListener("change", myFunction);
  }
</script>
</div>


    </div>
    <div class="col">
      <canvas class="canvas" id="DemoCanvas" width="500" height="775" style="border:1px solid black;"></canvas>
    <script>

    var canvas = document.getElementById('DemoCanvas');
    //Always check for properties and methods, to make sure your code doesn't break in other browsers.
    if (canvas.getContext)
     {
      var context = canvas.getContext('2d');

      // get data every second
      setInterval(function() {
        window.client.Sensors.getSensorValues()
          .then(function(result) {
            var data = result.obj;
            var drag = data.drag * 1000.0;
            var lift = data.lift * 1000.0;
            var amplitude = data.amplitude * 10;
            var sensorInfo = {
                drag: drag,
                lift: lift,
                angle: data.angle,
                amplitude: amplitude
            };
            // console.log(result.data);

            // draw your line using the values in the sensorInfo
            context.clearRect(0, 0, 500, 775);
            // Reset the current path
            context.beginPath();
            // Staring point (10,45)
            context.moveTo(300,400);
            // End point (180,47)
            context.lineTo(sensorInfo.drag*100, sensorInfo.lift*100);
            context.strokeStyle="black";
            // Make the line visible
            context.stroke();
            document.getElementById("Lift").innerHTML = "Lift: " + sensorInfo.lift.toFixed(2).fontcolor("#ff6666");
            document.getElementById("Drag").innerHTML = "Drag: " + sensorInfo.drag.toFixed(2).fontcolor("#ff6666");
            document.getElementById("Amplitude").innerHTML = "Amplitude: " + sensorInfo.amplitude.toFixed(2).fontcolor("#ff6666");
          });
      }, 1000);
     }

    </script>
    </div>
  </div>
</body>
</html>
